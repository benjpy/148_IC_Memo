AI IDE PROMPT — IC Memo Generator (Streamlit + Gemini + Google Docs)

You are a senior Python engineer.

Your task is to refactor and complete an existing Streamlit web app that:
- Reads uploaded documents (PDF, spreadsheets, images, text)
- Extracts information using Gemini 2.5 Flash
- Creates a Google Doc on the fly with structured IC memo sections

This is a personal Gmail workflow.
Service accounts are forbidden.
OAuth 2.0 MUST be used.

HARD CONSTRAINTS (NON-NEGOTIABLE)

1. DO NOT use service accounts
   - No google.oauth2.service_account
   - No GOOGLE_DOCS_CREDENTIALS
   - Delete or quarantine any existing service-account code

2. Google Docs authentication MUST use OAuth 2.0
   - User signs in with their personal Gmail
   - OAuth client type: Web application
   - Redirect URI: http://localhost:8501
   - Tokens stored in Streamlit session_state

3. Two separate auth systems
   - Gemini → API key from .env
   - Google Docs → OAuth credentials from .streamlit/secrets.toml

4. The app MUST create a Google Doc programmatically
   - No pre-existing templates
   - Return a clickable Google Docs URL

REQUIRED PROJECT STRUCTURE

ic_memo_app/
├── app/
│   ├── google_auth.py
│   ├── document_builder.py
│   ├── extraction.py
│   ├── cost_tracker.py
│   └── utils.py
├── streamlit_app.py
├── .env
└── .streamlit/
    └── secrets.toml

FUNCTIONAL REQUIREMENTS

Streamlit App
- Upload multiple files: PDF, CSV/XLSX, images, text
- Button: Generate Memo
- Status updates at each step
- Display:
  - Extracted structured data (JSON)
  - Google Docs link
  - Runtime, token usage, cost summary

Gemini Extraction
- Model: Gemini 2.5 Flash
- Pricing:
  - $0.30 per 1M input tokens
  - $2.50 per 1M output tokens
- Extract ONLY:
  - COMPANY NAME
  - BUSINESS DESCRIPTION
  - KEY METRICS: Cost, FMV, Equity %, Valuation Basis, Total $ Raised, SOSV Initial Investment Year
  - FUNDRAISING HISTORY
- Do not hallucinate; use "Unknown" if missing

Cost & Time Tracking
- Track:
  - total_input_tokens
  - total_output_tokens
  - total_cost_usd
  - total_runtime_seconds
- Print and display in Streamlit
- Do NOT write this into the Google Doc

GOOGLE DOCS OUTPUT REQUIREMENTS

- Create a new Google Doc per run
- Sections (fixed order):
  - COMPANY NAME
  - BUSINESS DESCRIPTION
  - FUNDRAISING HISTORY
- Section titles:
  - Uppercase
  - Bold
  - Larger font size than body text
- Body text:
  - Normal paragraph style
- Use documents.batchUpdate
- Return final document URL

AUTH IMPLEMENTATION DETAILS

- OAuth scopes:
  https://www.googleapis.com/auth/documents
  https://www.googleapis.com/auth/drive.file

- Credentials source:
  - client_id and client_secret from .streamlit/secrets.toml

- OAuth flow must:
  - Open Google consent screen
  - Persist credentials in st.session_state
  - Be reused across reruns

OUTPUT EXPECTATION

Produce:
1. Fully working Python code matching the structure above
2. Clean separation of concerns
3. No placeholder auth logic
4. No service-account remnants
5. Code that runs locally with:
   streamlit run streamlit_app.py

Assume the user already has:
- Google Docs API enabled
- Google Drive API enabled
- Gemini API key available

Do not explain concepts.
Do not provide alternatives.
Just implement the correct solution.
